<!-- src/app/components/single-quiz/single-quiz-form.component.html -->
<div class="form-container">
  <mat-tab-group>
    <!-- ===================== Single Quiz Tab ===================== -->
    <mat-tab label="Single Quiz">
      <mat-card>
        <form [formGroup]="quizForm" (ngSubmit)="addQuiz()">

          <!-- Question -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Question</mat-label>
            <input matInput formControlName="question" placeholder="Enter question" />
          </mat-form-field>

          <!-- Options -->
          <div formArrayName="options">
            <div *ngFor="let opt of options.controls; let i = index">
              <mat-form-field class="full-width" appearance="outline">
                <mat-label>Option {{ i + 1 }}</mat-label>
                <input matInput [formControlName]="i" placeholder="Option {{ i + 1 }}" />
              </mat-form-field>
            </div>
          </div>

          <!-- Correct Answer -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Correct Answer</mat-label>
            <input matInput formControlName="correctAnswer" placeholder="Enter correct answer" />
          </mat-form-field>

          <!-- Subject -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Subject</mat-label>
            <mat-select formControlName="subject">
              <mat-option *ngFor="let s of subjects" [value]="s">{{ s }}</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Sub Categories -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Sub Categories</mat-label>
            <mat-chip-grid #subGrid>
              <mat-chip-row *ngFor="let sub of subCategories" (removed)="removeSubCategory(sub)">
                {{ sub }}
                <button matChipRemove>
                  <mat-icon>cancel</mat-icon>
                </button>
              </mat-chip-row>
              <input
                #subInput
                matInput
                [formControl]="subCtrl"
                [matChipInputFor]="subGrid"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                (matChipInputTokenEnd)="addSubCategory($event)"
                [matAutocomplete]="autoSub"
                placeholder="Add or select subcategory" />
            </mat-chip-grid>
            <mat-autocomplete #autoSub="matAutocomplete" (optionSelected)="selectSubCategory($event)">
              <mat-option *ngFor="let option of filteredSubCategories | async" [value]="option">
                {{ option }}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>

          <!-- Exam Tags -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Exam Tags</mat-label>
            <mat-chip-grid #tagGrid>
              <mat-chip-row *ngFor="let tag of examTags" (removed)="removeExamTag(tag)">
                {{ tag }}
                <button matChipRemove>
                  <mat-icon>cancel</mat-icon>
                </button>
              </mat-chip-row>
              <input
                #tagInput
                matInput
                [formControl]="tagCtrl"
                [matChipInputFor]="tagGrid"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                (matChipInputTokenEnd)="addExamTag($event)"
                [matAutocomplete]="autoTag"
                placeholder="Add or select tag" />
            </mat-chip-grid>
            <mat-autocomplete #autoTag="matAutocomplete" (optionSelected)="selectExamTag($event)">
              <mat-option *ngFor="let option of filteredExamTags | async" [value]="option">
                {{ option }}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>

          <!-- Level -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Level</mat-label>
            <mat-select [formControl]="levelCtrl">
              <mat-option value="Easy">Easy</mat-option>
              <mat-option value="Medium">Medium</mat-option>
              <mat-option value="Hard">Hard</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Classes -->
          <mat-form-field class="full-width" appearance="outline">
            <mat-label>Classes</mat-label>
            <mat-chip-grid #classGrid>
              <mat-chip-row *ngFor="let cls of classTags" (removed)="removeClassTag(cls)">
                {{ cls }}
                <button matChipRemove>
                  <mat-icon>cancel</mat-icon>
                </button>
              </mat-chip-row>
              <input
                matInput
                [formControl]="classCtrl"
                [matChipInputFor]="classGrid"
                [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
                (matChipInputTokenEnd)="addClassTag($event)"
                [matAutocomplete]="autoClass"
                placeholder="Add or select class" />
            </mat-chip-grid>
            <mat-autocomplete #autoClass="matAutocomplete" (optionSelected)="selectClassTag($event)">
              <mat-option *ngFor="let option of filteredClasses | async" [value]="option">
                {{ option }}
              </mat-option>
            </mat-autocomplete>
          </mat-form-field>

          <div class="actions-row">
            <button mat-raised-button color="primary" type="submit">Add Single Quiz</button>
          </div>
        </form>
      </mat-card>
    </mat-tab>

    <!-- ===================== Bulk Upload Tab ===================== -->
    <mat-tab label="Bulk Upload">
      <mat-card>
        <h3>Paste Bulk Questions</h3>

        <!-- Subject -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Subject</mat-label>
          <mat-select [formControl]="bulkSubject">
            <mat-option *ngFor="let s of subjects" [value]="s">{{ s }}</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Sub Categories -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Sub Categories</mat-label>
          <mat-chip-grid #bulkSubGrid>
            <mat-chip-row *ngFor="let sub of bulkSubCategories" (removed)="removeBulkSubCategory(sub)">
              {{ sub }}
              <button matChipRemove>
                <mat-icon>cancel</mat-icon>
              </button>
            </mat-chip-row>
            <input
              matInput
              [formControl]="bulkSubCtrl"
              [matChipInputFor]="bulkSubGrid"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="addBulkSubCategory($event)"
              [matAutocomplete]="autoBulkSub"
              placeholder="Add or select subcategory" />
          </mat-chip-grid>
          <mat-autocomplete #autoBulkSub="matAutocomplete" (optionSelected)="selectBulkSubCategory($event)">
            <mat-option *ngFor="let option of filteredBulkSubCategories | async" [value]="option">
              {{ option }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <!-- Exam Tags -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Exam Tags</mat-label>
          <mat-chip-grid #bulkTagGrid>
            <mat-chip-row *ngFor="let tag of bulkExamTags" (removed)="removeBulkExamTag(tag)">
              {{ tag }}
              <button matChipRemove>
                <mat-icon>cancel</mat-icon>
              </button>
            </mat-chip-row>
            <input
              matInput
              [formControl]="bulkTagCtrl"
              [matChipInputFor]="bulkTagGrid"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="addBulkExamTag($event)"
              [matAutocomplete]="autoBulkTag"
              placeholder="Add or select tag" />
          </mat-chip-grid>
          <mat-autocomplete #autoBulkTag="matAutocomplete" (optionSelected)="selectBulkExamTag($event)">
            <mat-option *ngFor="let option of filteredBulkExamTags | async" [value]="option">
              {{ option }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <!-- Level -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Level</mat-label>
          <mat-select [formControl]="bulkLevelCtrl">
            <mat-option value="Easy">Easy</mat-option>
            <mat-option value="Medium">Medium</mat-option>
            <mat-option value="Hard">Hard</mat-option>
          </mat-select>
        </mat-form-field>

        <!-- Classes -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Classes</mat-label>
          <mat-chip-grid #bulkClassGrid>
            <mat-chip-row *ngFor="let cls of bulkClasses" (removed)="removeBulkClass(cls)">
              {{ cls }}
              <button matChipRemove>
                <mat-icon>cancel</mat-icon>
              </button>
            </mat-chip-row>
            <input
              matInput
              [formControl]="bulkClassCtrl"
              [matChipInputFor]="bulkClassGrid"
              [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
              (matChipInputTokenEnd)="addBulkClass($event)"
              [matAutocomplete]="autoBulkClass"
              placeholder="Add or select class" />
          </mat-chip-grid>
          <mat-autocomplete #autoBulkClass="matAutocomplete" (optionSelected)="selectBulkClass($event)">
            <mat-option *ngFor="let option of filteredBulkClasses | async" [value]="option">
              {{ option }}
            </mat-option>
          </mat-autocomplete>
        </mat-form-field>

        <!-- Bulk Textarea -->
        <mat-form-field class="full-width" appearance="outline">
          <mat-label>Bulk Questions</mat-label>
          <textarea
            matInput
            [formControl]="bulkCtrl"
            rows="15"
            placeholder="Paste questions in format:&#10;Question?&#10;A) ...&#10;B) ...&#10;C) ...&#10;D) ...&#10;Answer: ..." >
          </textarea>
        </mat-form-field>

        <div class="actions-row">
          <button mat-raised-button color="primary" (click)="parseAndUploadBulk()">Upload Bulk</button>
        </div>
      </mat-card>
    </mat-tab>
  </mat-tab-group>
</div>
